<!DOCTYPE html>
<html lang="en">
<head>
    <script>
  if (localStorage.getItem('theme') === 'dark') {
    document.documentElement.classList.add('dark');
    document.body?.classList?.add('dark');
  }
</script>
  <meta charset="UTF-8" />
  <title>A People's History of the United States</title>
  <script src="https://unpkg.com/epubjs/dist/epub.min.js"></script>
  <style>
    :root {
      --bg: #f9f9f9;
      --text: #333;
      --card: #fff;
    }
    body.dark {
      --bg: #1e1e1e;
      --text: #f0f0f0;
      --card: #2c2c2c;
    }
    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
    }
    h1, h2 {
      margin-bottom: 10px;
    }
    .meta p {
      margin: 5px 0;
    }
    #viewer {
      width: 100%;
      height: 600px;
      border: 1px solid #ccc;
      margin-top: 20px;
      background: white;
    }
    .btns {
      margin: 20px 0;
    }
    .btns a, .btns button {
      margin-right: 10px;
      padding: 10px 15px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      text-decoration: none;
    }
    .btns a:hover, .btns button:hover {
      background: #0056b3;
    }
  </style>

<body>
  <h1>A People's History of the United States</h1>

  <div class="meta">
    <h2>by Howard Zinn</h2>
    <p><strong>Publication Year:</strong> 1980</p>
    <p><strong>Time Period Covered:</strong> 1492â€“2001</p>
    <p><strong>Region:</strong> United States</p>
    <p><strong>Themes:</strong> Social history, labor, civil rights, anti-establishment</p>
    <p><strong>Audience:</strong> General public, students</p>
    <p><strong>Summary:</strong> A bottom-up view of U.S. history, focusing on marginalized voices and systemic critiques of power, war, and capitalism. Zinn presents American history through the eyes of workers, women, African Americans, Native Americans, and others often left out of mainstream narratives.</p>
  </div>

  <div class="btns">
    <button onclick="toggleReader()"> View Book</button>
    <a href="epubs/A people's history of the United States_ 1492-present -- Zinn, Howard -- 2005 -- Harper Perennial -- e0be63f1b82fb8bc0bafec54e701926c -- Annaâ€™s Archive.epub" download> Download EPUB</a>
    <a href="index.html"> Back to Home</a>
  </div>

  <div id="viewer" style="display: none;"></div>
  
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const viewer = document.getElementById("viewer");
    let bookLoaded = false;

    document.querySelector("button").addEventListener("click", () => {
      if (!bookLoaded) {
        viewer.style.display = "block";

        const book = ePub("../epubs/zinn.epub", {
          openAs: 'epub',
          workers: false  // ðŸ‘ˆ disable workers for GitHub Pages compatibility
        });

        const rendition = book.renderTo("viewer", {
          width: "100%",
          height: 600
        });

        rendition.display().catch(err => {
          console.error("EPUB rendering failed:", err);
          viewer.innerHTML = "<p style='color:red;'>EPUB rendering failed.</p>";
        });

        bookLoaded = true;
      } else {
        viewer.style.display = viewer.style.display === "none" ? "block" : "none";
      }
    });
  });
</script>
</body>
</html>
